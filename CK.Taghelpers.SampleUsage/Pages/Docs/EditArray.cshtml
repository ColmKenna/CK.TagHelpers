@page
@model EditArrayModel
@{
    ViewData["Title"] = "EditArray TagHelper";
}

<div class="docs-container">

    <nav class="docs-breadcrumb">
        <a asp-page="/Docs/Index">TagHelper Reference</a> &rsaquo; EditArray
    </nav>

    <div class="docs-header">
        <h1>EditArray TagHelper</h1>
        <p class="docs-subtitle">A dynamic collection editor with inline edit, delete, reorder, and add-new capabilities.</p>
        <div class="docs-meta">
            <div><span class="docs-meta-label">Element:</span> <code>&lt;edit-array&gt;</code></div>
            <div><span class="docs-meta-label">Class:</span> <code>EditArrayTagHelper</code></div>
            <div><span class="docs-meta-label">Namespace:</span> <code>CK.Taghelpers.TagHelpers.EditArray</code></div>
        </div>
        <div class="docs-meta mt-2">
            <div><span class="docs-meta-label">CSS:</span> <code>_content/CK.Taghelpers/css/editArray.css</code></div>
            <div><span class="docs-meta-label">JS:</span> <code>_content/CK.Taghelpers/js/editArray.js</code>, <code>_content/CK.Taghelpers/js/editArray-callbacks.js</code> (optional)</div>
        </div>
    </div>

    <!-- 2. Overview -->
    <div class="docs-section">
        <h2>Overview</h2>
        <p>
            The EditArray TagHelper renders a server-side collection of objects as an interactive list where
            each item can be edited in-place, marked for deletion, and optionally reordered. New items can
            be added via a template mechanism without a page reload. The TagHelper produces all the required
            HTML structure; the companion <code>editArray.js</code> module handles client-side state transitions
            using event delegation (no inline <code>onclick</code> handlers).
        </p>
        <p>
            The component integrates directly with ASP.NET Core model binding: field names are generated in
            standard <code>Collection[index].Property</code> format so a bound PageModel or controller
            action receives the edited collection on POST. It is compatible with jQuery unobtrusive validation
            and re-parses the validator after new items are added.
        </p>
        <p>
            The TagHelper supports two rendering modes. In <strong>edit-only</strong> mode each item is always
            shown in its edit form. In <strong>display mode</strong> (enabled via
            <code>asp-display-mode="true"</code>) each item shows a read-only view by default, and the user
            clicks Edit to switch it to the editable form. Display mode requires a separate display partial
            view specified via <code>asp-display-view-name</code>.
        </p>
    </div>

    <!-- 3. Getting Started -->
    <div class="docs-section">
        <h2>Getting Started</h2>
        <p>
            Provide a partial view for editing items (e.g. <code>_PersonEditor.cshtml</code>), then add
            <code>&lt;edit-array&gt;</code> to your page:
        </p>
<pre><code class="language-cshtml">&lt;!-- _PersonEditor.cshtml (partial) --&gt;
&lt;div&gt;
    &lt;label asp-for="Name"&gt;&lt;/label&gt;
    &lt;input asp-for="Name" class="form-control" /&gt;
    &lt;span asp-validation-for="Name"&gt;&lt;/span&gt;
&lt;/div&gt;</code></pre>

<pre><code class="language-cshtml">&lt;!-- Page or View --&gt;
&lt;form method="post"&gt;
    &lt;edit-array asp-array-id="people"
                asp-items="@@Model.People"
                asp-view-name="_PersonEditor"
                asp-for="People" /&gt;
    &lt;button type="submit" class="btn btn-primary mt-2"&gt;Save&lt;/button&gt;
&lt;/form&gt;</code></pre>

        <p>
            The <code>editArray.css</code> and <code>editArray.js</code> files are included in the sample
            project's default <code>_Layout.cshtml</code>. If you are using the library in your own project,
            add them to your layout:
        </p>
<pre><code class="language-html">&lt;link rel="stylesheet" href="~/_content/CK.Taghelpers/css/editArray.css" /&gt;
&lt;script src="~/_content/CK.Taghelpers/js/editArray.js"&gt;&lt;/script&gt;</code></pre>
    </div>

    <!-- 4. Attribute Reference -->
    <div class="docs-section">
        <h2>Attribute Reference</h2>
        <p>All attributes use the <code>asp-</code> prefix to follow ASP.NET Core TagHelper conventions.</p>

        <h3>Core Binding</h3>
        <table class="docs-table">
            <thead>
                <tr><th>Attribute</th><th>Type</th><th>Default</th><th>Description</th></tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>asp-array-id</code> <span class="badge-required">Required</span></td>
                    <td><code>string</code></td>
                    <td>—</td>
                    <td>
                        Unique identifier for this edit array. The TagHelper automatically prepends
                        <code>edit-array-</code>, so <code>asp-array-id="people"</code> yields
                        <code>id="edit-array-people"</code> on the container. Must start with a letter and
                        contain only letters, digits, hyphens, and underscores.
                    </td>
                </tr>
                <tr>
                    <td><code>asp-items</code> <span class="badge-required">Required</span></td>
                    <td><code>IEnumerable&lt;object&gt;</code></td>
                    <td>—</td>
                    <td>The collection of items to render. Pass an empty collection (not <code>null</code>) when there are no existing items.</td>
                </tr>
                <tr>
                    <td><code>asp-view-name</code> <span class="badge-required">Required</span></td>
                    <td><code>string</code></td>
                    <td>—</td>
                    <td>Path to the partial view used to render each item in edit mode (e.g. <code>"_PersonEditor"</code> or <code>"~/Views/Shared/_PersonEditor.cshtml"</code>).</td>
                </tr>
                <tr>
                    <td><code>asp-for</code></td>
                    <td><code>ModelExpression?</code></td>
                    <td>—</td>
                    <td>
                        Model expression for the collection property. When specified, field names are
                        generated in fully qualified form (e.g. <code>Person.Addresses[0].Street</code>)
                        for correct model binding on POST.
                    </td>
                </tr>
            </tbody>
        </table>

        <h3>Display Mode</h3>
        <table class="docs-table">
            <thead>
                <tr><th>Attribute</th><th>Type</th><th>Default</th><th>Description</th></tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>asp-display-mode</code></td>
                    <td><code>bool</code></td>
                    <td><code>false</code></td>
                    <td>When <code>true</code>, existing items start in display (read-only) view. Requires <code>asp-display-view-name</code> to also be set.</td>
                </tr>
                <tr>
                    <td><code>asp-display-view-name</code></td>
                    <td><code>string?</code></td>
                    <td>—</td>
                    <td>Path to the partial view used to render each item in display (read-only) mode. Required when <code>asp-display-mode="true"</code>.</td>
                </tr>
                <tr>
                    <td><code>asp-template</code></td>
                    <td><code>bool</code></td>
                    <td><code>false</code></td>
                    <td>
                        When <code>true</code>, renders an HTML <code>&lt;template&gt;</code> element containing
                        a blueprint for new items with <code>__index__</code> placeholder tokens. Required for
                        the Add New Item button to function.
                    </td>
                </tr>
                <tr>
                    <td><code>asp-add-button</code></td>
                    <td><code>bool</code></td>
                    <td><code>false</code></td>
                    <td>When <code>true</code>, renders an "Add New Item" button below the template. Requires <code>asp-template="true"</code>.</td>
                </tr>
                <tr>
                    <td><code>asp-enable-reordering</code></td>
                    <td><code>bool</code></td>
                    <td><code>false</code></td>
                    <td>When <code>true</code>, renders Move Up / Move Down buttons on each item. Also adds <code>data-reorder-enabled="true"</code> to the container.</td>
                </tr>
                <tr>
                    <td><code>asp-empty-placeholder</code></td>
                    <td><code>string?</code></td>
                    <td>—</td>
                    <td>Text shown inside a <code>.edit-array-placeholder</code> element when the collection is empty. HTML-encoded before output.</td>
                </tr>
                <tr>
                    <td><code>asp-max-items</code></td>
                    <td><code>int?</code></td>
                    <td>—</td>
                    <td>Maximum number of items the user can add. The Add button is disabled once this count is reached. Must be greater than 0 if set.</td>
                </tr>
            </tbody>
        </table>

        <h3>JavaScript Callbacks</h3>
        <table class="docs-table">
            <thead>
                <tr><th>Attribute</th><th>Type</th><th>Default</th><th>Description</th></tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>asp-on-done</code></td>
                    <td><code>string?</code></td>
                    <td>—</td>
                    <td>
                        Name of a JavaScript function called when the user clicks Done, <em>before</em> the
                        edit-to-display transition. Return <code>false</code> to cancel the transition (e.g.
                        to block when validation fails). Must be a valid JS identifier.
                    </td>
                </tr>
                <tr>
                    <td><code>asp-on-update</code></td>
                    <td><code>string?</code></td>
                    <td>—</td>
                    <td>
                        Name of a JavaScript function called <em>after</em> the edit-to-display transition
                        completes. Receives the item's DOM element ID as a parameter. Cannot cancel the
                        transition. Must be a valid JS identifier.
                    </td>
                </tr>
                <tr>
                    <td><code>asp-on-delete</code></td>
                    <td><code>string?</code></td>
                    <td>—</td>
                    <td>Name of a JavaScript function called after an item is marked for deletion. Receives the item's DOM element ID as a parameter. Must be a valid JS identifier.</td>
                </tr>
            </tbody>
        </table>

        <h3>Appearance</h3>
        <table class="docs-table">
            <thead>
                <tr><th>Attribute</th><th>Type</th><th>Default</th><th>Description</th></tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>asp-container-class</code></td>
                    <td><code>string?</code></td>
                    <td><code>"edit-array-container"</code></td>
                    <td>CSS class(es) for the outer container element. The default class <code>edit-array-container</code> is always included; additional classes are appended.</td>
                </tr>
                <tr>
                    <td><code>asp-item-class</code></td>
                    <td><code>string?</code></td>
                    <td><code>"edit-array-item"</code></td>
                    <td>CSS class(es) for each item wrapper element. The default class <code>edit-array-item</code> is always included.</td>
                </tr>
                <tr>
                    <td><code>asp-button-class</code></td>
                    <td><code>string</code></td>
                    <td><code>"btn"</code></td>
                    <td>Base CSS class applied to all action buttons (Edit, Delete, Done, Cancel, Add). Button-specific modifier classes are appended automatically.</td>
                </tr>
                <tr>
                    <td><code>asp-reorder-button-class</code></td>
                    <td><code>string</code></td>
                    <td><code>"btn btn-outline-secondary"</code></td>
                    <td>CSS class for Move Up / Move Down buttons. Used only when <code>asp-enable-reordering="true"</code>. Falls back to <code>asp-button-class</code> when empty.</td>
                </tr>
            </tbody>
        </table>

        <h3>Button Text</h3>
        <table class="docs-table">
            <thead>
                <tr><th>Attribute</th><th>Type</th><th>Default</th><th>Description</th></tr>
            </thead>
            <tbody>
                <tr><td><code>asp-edit-text</code></td><td><code>string</code></td><td><code>"Edit"</code></td><td>Label for the Edit button (display mode only).</td></tr>
                <tr><td><code>asp-done-text</code></td><td><code>string</code></td><td><code>"Done"</code></td><td>Label for the Done button (display mode only).</td></tr>
                <tr><td><code>asp-cancel-text</code></td><td><code>string</code></td><td><code>"Cancel"</code></td><td>Label for the Cancel button (display mode only).</td></tr>
                <tr><td><code>asp-delete-text</code></td><td><code>string</code></td><td><code>"Delete"</code></td><td>Label for the Delete button. Also used as the initial button text when an item is not yet marked for deletion.</td></tr>
                <tr><td><code>asp-undelete-text</code></td><td><code>string</code></td><td><code>"Undelete"</code></td><td>Label shown on the Delete button after an item has been marked for deletion, allowing the user to restore it.</td></tr>
                <tr><td><code>asp-add-text</code></td><td><code>string</code></td><td><code>"Add New Item"</code></td><td>Label for the Add button.</td></tr>
                <tr><td><code>asp-move-up-text</code></td><td><code>string</code></td><td><code>"Move Up"</code></td><td>Label for the Move Up reorder button.</td></tr>
                <tr><td><code>asp-move-down-text</code></td><td><code>string</code></td><td><code>"Move Down"</code></td><td>Label for the Move Down reorder button.</td></tr>
            </tbody>
        </table>
    </div>

    <!-- 5. Configuration -->
    <div class="docs-section">
        <h2>Configuration and Usage Guidance</h2>

        <h3>Edit-only mode (basic)</h3>
        <p>
            In edit-only mode every item is always shown in its edit form. There are no display view,
            Edit, Done, or Cancel buttons — only a Delete button per item:
        </p>
<pre><code class="language-cshtml">&lt;edit-array asp-array-id="addresses"
            asp-items="@@Model.Addresses"
            asp-view-name="_AddressEditor"
            asp-for="Addresses" /&gt;</code></pre>

        <h3>Display mode with Edit/Done toggle</h3>
        <p>
            Supply both a display view and an edit view. Items start in read-only display mode; the user
            clicks Edit to switch to the editable form, then Done to return to display (or Cancel to discard
            changes):
        </p>
<pre><code class="language-cshtml">&lt;edit-array asp-array-id="team"
            asp-items="@@Model.TeamMembers"
            asp-view-name="_PersonEditor"
            asp-display-view-name="_PersonDisplay"
            asp-display-mode="true"
            asp-for="TeamMembers" /&gt;</code></pre>

        <h3>Allowing new items to be added</h3>
        <p>
            Enable both <code>asp-template</code> and <code>asp-add-button</code> to allow the user to
            add items without a page refresh. The TagHelper renders a hidden <code>&lt;template&gt;</code>
            element; JavaScript clones it, replaces <code>__index__</code> tokens, and appends the clone
            to the list:
        </p>
<pre><code class="language-cshtml">&lt;edit-array asp-array-id="tasks"
            asp-items="@@Model.Tasks"
            asp-view-name="_TaskEditor"
            asp-template="true"
            asp-add-button="true"
            asp-for="Tasks" /&gt;</code></pre>

        <h3>Limiting the number of items</h3>
        <p>Combine <code>asp-max-items</code> with the add button to cap the list length. The Add button is disabled when the limit is reached:</p>
<pre><code class="language-cshtml">&lt;edit-array asp-array-id="tags"
            asp-items="@@Model.Tags"
            asp-view-name="_TagEditor"
            asp-template="true"
            asp-add-button="true"
            asp-max-items="5"
            asp-for="Tags" /&gt;</code></pre>

        <h3>Reordering</h3>
        <p>Set <code>asp-enable-reordering="true"</code> to add Move Up / Move Down buttons to each item:</p>
<pre><code class="language-cshtml">&lt;edit-array asp-array-id="steps"
            asp-items="@@Model.Steps"
            asp-view-name="_StepEditor"
            asp-enable-reordering="true"
            asp-for="Steps" /&gt;</code></pre>

        <h3>Empty state placeholder</h3>
        <p>Show a message when the collection has no items:</p>
<pre><code class="language-cshtml">&lt;edit-array asp-array-id="notes"
            asp-items="@@Model.Notes"
            asp-view-name="_NoteEditor"
            asp-template="true"
            asp-add-button="true"
            asp-empty-placeholder="No notes yet. Click Add New Item to get started."
            asp-for="Notes" /&gt;</code></pre>

        <h3>Callbacks: blocking Done with validation</h3>
        <p>
            Use <code>asp-on-done</code> to run validation before the edit-to-display transition.
            Return <code>false</code> to prevent the transition:
        </p>
<pre><code class="language-cshtml">&lt;edit-array asp-array-id="contacts"
            asp-items="@@Model.Contacts"
            asp-view-name="_ContactEditor"
            asp-display-view-name="_ContactDisplay"
            asp-display-mode="true"
            asp-on-done="guardContactDone"
            asp-for="Contacts" /&gt;

&lt;script src="~/_content/CK.Taghelpers/js/editArray-callbacks.js"&gt;&lt;/script&gt;
&lt;script&gt;
    editArrayCallbacks.register('guardContactDone',
        editArrayCallbacks.validationGuard({ statusElementId: 'validationStatus' })
    );
&lt;/script&gt;
&lt;div id="validationStatus"&gt;&lt;/div&gt;</code></pre>

        <h3>Callbacks: reacting to updates and deletions</h3>
<pre><code class="language-cshtml">&lt;edit-array asp-array-id="items"
            ...
            asp-on-update="onItemSaved"
            asp-on-delete="onItemDeleted" /&gt;

&lt;script&gt;
    function onItemSaved(itemId) {
        console.log('Item saved:', itemId);
    }
    function onItemDeleted(itemId) {
        console.log('Item marked for deletion:', itemId);
    }
&lt;/script&gt;</code></pre>

        <h3>Display view and the data-display-for contract</h3>
        <p>
            When display mode is enabled, the JavaScript module syncs display values from the form inputs
            after Done is clicked. To wire up an input to a display element, give the display element a
            <code>data-display-for</code> attribute equal to the edit input's <code>id</code>:
        </p>
<pre><code class="language-cshtml">&lt;!-- _ContactDisplay.cshtml --&gt;
&lt;span data-display-for="@@Html.IdFor(m =&gt; m.Name)"&gt;@@Model.Name&lt;/span&gt;

&lt;!-- _ContactEditor.cshtml --&gt;
&lt;input asp-for="Name" class="form-control" /&gt;</code></pre>

        <h3>Validation integration</h3>
        <p>
            The TagHelper re-parses jQuery unobtrusive validation (<code>$.validator.unobtrusive.parse</code>)
            after a new item is added, so validation attributes on dynamically inserted inputs are correctly
            registered. The <code>editarray:edit-saving</code> custom event is cancelable; call
            <code>event.preventDefault()</code> in a listener to block the Done transition:
        </p>
<pre><code class="language-javascript">document.addEventListener('editarray:edit-saving', function(event) {
    var editContainer = event.detail.editContainer;
    var isValid = /* your validation logic */;
    if (!isValid) {
        event.preventDefault();
    }
});</code></pre>

        <h3>Accessibility</h3>
        <p>The TagHelper generates the following ARIA and semantic attributes:</p>
        <ul>
            <li>The items wrapper has <code>aria-live="polite"</code> and <code>role="list"</code>.</li>
            <li>Each item wrapper has <code>role="listitem"</code>.</li>
            <li>All buttons have <code>aria-label</code> attributes describing their action and the item index (e.g. <code>"Edit item 1"</code>).</li>
            <li>Reorder buttons have directional aria-labels (e.g. <code>"Move item 2 up"</code>).</li>
            <li>When a new item is added, focus moves to the first input in the new edit form.</li>
            <li>After cancelling a new unsaved item, focus returns to the Add button.</li>
        </ul>

        <h3>Generated DOM ID structure</h3>
        <p>All IDs are derived from the <code>asp-array-id</code> value (e.g. <code>asp-array-id="people"</code>):</p>
        <table class="docs-table">
            <thead><tr><th>Element</th><th>ID</th></tr></thead>
            <tbody>
                <tr><td>Container</td><td><code>edit-array-people</code></td></tr>
                <tr><td>Items wrapper</td><td><code>edit-array-people-items</code></td></tr>
                <tr><td>Item at index 0</td><td><code>edit-array-people-item-0</code></td></tr>
                <tr><td>Display section (item 0)</td><td><code>edit-array-people-item-0-display</code></td></tr>
                <tr><td>Edit section (item 0)</td><td><code>edit-array-people-item-0-edit</code></td></tr>
                <tr><td>Template element</td><td><code>edit-array-people-template</code></td></tr>
                <tr><td>Add button</td><td><code>edit-array-people-add</code></td></tr>
            </tbody>
        </table>
    </div>

    <!-- 6. JavaScript API -->
    <div class="docs-section">
        <h2>JavaScript API</h2>

        <h3>Custom Events</h3>
        <p>All events are dispatched on <code>document</code>.</p>
        <table class="docs-table">
            <thead>
                <tr><th>Event</th><th>Detail</th><th>Cancelable</th><th>Description</th></tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>editarray:init</code></td>
                    <td><code>{ container }</code></td>
                    <td>No</td>
                    <td>Fired once per container on page load after the module initialises. Use to wire up per-container logic.</td>
                </tr>
                <tr>
                    <td><code>editarray:item-added</code></td>
                    <td><code>{ containerId, itemId, container }</code></td>
                    <td>No</td>
                    <td>Fired after a new item is cloned from the template and appended to the DOM.</td>
                </tr>
                <tr>
                    <td><code>editarray:edit-saving</code></td>
                    <td><code>{ itemId, editContainer }</code></td>
                    <td><strong>Yes</strong></td>
                    <td>Fired before switching from edit to display mode. Call <code>event.preventDefault()</code> to block the transition (e.g. for validation).</td>
                </tr>
                <tr>
                    <td><code>editarray:edit-entered</code></td>
                    <td><code>{ itemId, editContainer }</code></td>
                    <td>No</td>
                    <td>Fired after switching from display to edit mode.</td>
                </tr>
            </tbody>
        </table>

        <h3>Global Functions (editArray.js)</h3>
        <table class="docs-table">
            <thead>
                <tr><th>Function</th><th>Parameters</th><th>Description</th></tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>addNewItem(containerId, templateId)</code></td>
                    <td><code>string, string</code></td>
                    <td>Clones the template, replaces <code>__index__</code> tokens, appends the clone, refreshes validation, and focuses the first input. Enforces <code>asp-max-items</code>.</td>
                </tr>
                <tr>
                    <td><code>toggleEditMode(itemId)</code></td>
                    <td><code>string</code></td>
                    <td>Toggles an item between display and edit modes. Fires <code>asp-on-done</code> and <code>editarray:edit-saving</code> before switching from edit to display.</td>
                </tr>
                <tr>
                    <td><code>cancelEdit(itemId)</code></td>
                    <td><code>string</code></td>
                    <td>Cancels in-progress edits. Restores the snapshot taken when Edit was clicked. Removes the item entirely if it was never saved.</td>
                </tr>
                <tr>
                    <td><code>markForDeletion(itemId)</code></td>
                    <td><code>string</code></td>
                    <td>Toggles an item's deletion state. Applies the <code>deleted</code> CSS class, sets <code>data-deleted="true"</code>, updates the hidden <code>IsDeleted</code> input, and swaps the button label between <code>asp-delete-text</code> and <code>asp-undelete-text</code>.</td>
                </tr>
                <tr>
                    <td><code>moveItem(containerId, itemId, offset)</code></td>
                    <td><code>string, string, number</code></td>
                    <td>Moves an item up (<code>offset=-1</code>) or down (<code>offset=1</code>) in the list and renumbers all items.</td>
                </tr>
            </tbody>
        </table>

        <h3>editArrayCallbacks namespace</h3>
        <p>
            The optional <code>editArray-callbacks.js</code> library provides composable factory functions
            for the callback hooks. Include it after <code>editArray.js</code>.
        </p>
        <table class="docs-table">
            <thead>
                <tr><th>Function</th><th>Description</th></tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>editArrayCallbacks.register(name, fn)</code></td>
                    <td>Registers a callback function on <code>window</code> under the given name. Validates the name against the same identifier regex enforced by the C# TagHelper.</td>
                </tr>
                <tr>
                    <td><code>editArrayCallbacks.validationGuard(options)</code></td>
                    <td>
                        Returns an <code>onDone</code> callback that validates the edit form using jQuery
                        unobtrusive validation (or inspects <code>span[data-valmsg-for]</code> as fallback).
                        Returns <code>false</code> to block the transition when validation fails.
                        Options: <code>statusElementId</code>, <code>validMessage</code>, <code>invalidMessage</code>,
                        <code>validClass</code>, <code>invalidClass</code>.
                    </td>
                </tr>
                <tr>
                    <td><code>editArrayCallbacks.statusUpdater(options)</code></td>
                    <td>Returns a callback that updates a DOM element's text content (and optionally its CSS class). Options: <code>elementId</code>, <code>message</code> (string or function), <code>className</code>.</td>
                </tr>
                <tr>
                    <td><code>editArrayCallbacks.notifier(options)</code></td>
                    <td>Returns a callback that logs to the console and optionally calls a toast function. Options: <code>prefix</code>, <code>message</code>, <code>level</code>, <code>toast</code>.</td>
                </tr>
                <tr>
                    <td><code>editArrayCallbacks.compose(...fns)</code></td>
                    <td>Composes multiple callbacks into one. If any function returns <code>false</code>, execution stops and <code>false</code> is returned (safe for <code>asp-on-done</code> guards).</td>
                </tr>
            </tbody>
        </table>

        <p>Example — combining a validation guard with a notifier:</p>
<pre><code class="language-javascript">editArrayCallbacks.register('onPersonDone',
    editArrayCallbacks.compose(
        editArrayCallbacks.validationGuard(),
        editArrayCallbacks.notifier({ message: 'Person saved' })
    )
);</code></pre>

        <h3>CSS Custom Properties</h3>
        <table class="docs-table">
            <thead>
                <tr><th>Property</th><th>Default</th><th>Description</th></tr>
            </thead>
            <tbody>
                <tr><td><code>--ea-deleted-opacity</code></td><td><code>0.5</code></td><td>Opacity applied to items marked for deletion.</td></tr>
                <tr><td><code>--ea-deleted-bg</code></td><td><code>#f8d7da</code></td><td>Background colour of items marked for deletion.</td></tr>
                <tr><td><code>--ea-placeholder-color</code></td><td><code>#6c757d</code></td><td>Text colour of the empty-state placeholder.</td></tr>
            </tbody>
        </table>
    </div>

    <!-- 7. Notes -->
    <div class="docs-section">
        <h2>Notes and Known Limitations</h2>
        <ul>
            <li>
                <strong>Item type must have a parameterless constructor</strong> when <code>asp-template="true"</code>
                is set. The TagHelper calls <code>Activator.CreateInstance(itemType)</code> to create a blank
                template model. An <code>InvalidOperationException</code> is thrown at render time if the type
                lacks a parameterless constructor.
            </li>
            <li>
                <strong>Configuration errors render an inline diagnostic panel.</strong> Missing required
                attributes or invalid values (invalid CSS class characters, non-identifier callback names,
                etc.) render a <code>.edit-array-error.alert.alert-danger</code> panel instead of throwing,
                which helps identify issues during development without a stack trace.
            </li>
            <li>
                <strong><code>asp-array-id</code> is auto-prefixed.</strong> The value you provide is
                prefixed with <code>edit-array-</code> on the DOM container. JavaScript functions that
                reference the container ID (e.g. <code>addNewItem</code>) expect the full prefixed ID
                (e.g. <code>"edit-array-people"</code>).
            </li>
            <li>
                <strong>Callback names are validated as JavaScript identifiers.</strong> The TagHelper
                enforces a regex on <code>asp-on-done</code>, <code>asp-on-update</code>, and
                <code>asp-on-delete</code> attribute values to prevent XSS. Only letters, digits, underscores,
                and dollar signs are allowed, starting with a letter, underscore, or dollar sign.
            </li>
            <li>
                <strong>CSS class attributes are validated.</strong> <code>asp-container-class</code>,
                <code>asp-item-class</code>, <code>asp-button-class</code>, and
                <code>asp-reorder-button-class</code> are validated to contain only alphanumeric characters,
                spaces, hyphens, and underscores. Invalid values produce a diagnostic error panel.
            </li>
            <li>
                <strong>Depends on Bootstrap button classes by default.</strong> The default
                <code>asp-button-class="btn"</code> and the auto-appended modifier classes
                (<code>btn-primary</code>, <code>btn-danger</code>, etc.) assume Bootstrap 5 is loaded.
                Override <code>asp-button-class</code> with your own base class if you are not using Bootstrap.
            </li>
            <li>
                <strong>jQuery unobtrusive validation is optional.</strong> The module checks for
                <code>$.validator.unobtrusive</code> at runtime and silently no-ops if it is absent.
                Server-side validation always works regardless of whether the JS validation library is loaded.
            </li>
        </ul>
    </div>

</div>
