@model EditArrayAttributesViewModel

@{
    ViewData["Title"] = "EditArray - Attributes and Configuration";
}

<div class="example-page">
    <h1>@ViewData["Title"]</h1>
    <p class="page-description">
        Each example focuses on a specific attribute set so you can see how configuration affects behavior.
    </p>

    <nav class="example-nav">
        <a asp-controller="TagHelperExamples" asp-action="Index">&larr; Back to EditArray examples</a>
    </nav>

    <section class="example-section" id="template-and-add">
        <h2>Template and add button</h2>
        <p class="example-description">
            Enable the template and add button to let users create new items dynamically.
            Use <code>asp-max-items</code> to cap the list size.
        </p>

        <div class="example-container row g-3">
            <div class="example-rendered col-lg-6">
                <h3 class="h6">Result</h3>
                <edit-array asp-array-id="attr-template"
                            asp-items="Model.TemplateMembers"
                            asp-view-name="~/Views/TagHelperExamples/EditArray/_PersonEditor.cshtml"
                            asp-display-view-name="~/Views/TagHelperExamples/EditArray/_PersonDisplay.cshtml"
                            asp-display-mode="true"
                            asp-cancel-text="Cancel"
                            asp-template="true"
                            asp-add-button="true"
                            asp-max-items="3"
                            asp-add-text="Add teammate">
                </edit-array>
            </div>
            <div class="example-source col-lg-6">
                <h3 class="h6">Source</h3>
                <pre><code class="language-cshtml">@Html.Raw("&lt;edit-array asp-array-id=\"attr-template\"\n            asp-items=\"Model.TemplateMembers\"\n            asp-view-name=\"~/Views/TagHelperExamples/EditArray/_PersonEditor.cshtml\"\n            asp-display-view-name=\"~/Views/TagHelperExamples/EditArray/_PersonDisplay.cshtml\"\n            asp-display-mode=\"true\"\n            asp-cancel-text=\"Cancel\"\n            asp-template=\"true\"\n            asp-add-button=\"true\"\n            asp-max-items=\"3\"\n            asp-add-text=\"Add teammate\"&gt;\n&lt;/edit-array&gt;")</code></pre>
            </div>
        </div>
    </section>

    <section class="example-section" id="custom-styling">
        <h2>Custom styling classes</h2>
        <p class="example-description">
            Override container, item, and button classes with Bootstrap utility classes.
        </p>

        <div class="example-container row g-3">
            <div class="example-rendered col-lg-6">
                <h3 class="h6">Result</h3>
                <edit-array asp-array-id="attr-styles"
                            asp-items="Model.StyledMembers"
                            asp-view-name="~/Views/TagHelperExamples/EditArray/_PersonEditor.cshtml"
                            asp-display-view-name="~/Views/TagHelperExamples/EditArray/_PersonDisplay.cshtml"
                            asp-display-mode="true"
                            asp-cancel-text="Discard"
                            asp-container-class="border border-warning rounded p-3 bg-light"
                            asp-item-class="border rounded p-2 mb-2"
                            asp-button-class="btn btn-outline-primary">
                </edit-array>
            </div>
            <div class="example-source col-lg-6">
                <h3 class="h6">Source</h3>
                <pre><code class="language-cshtml">@Html.Raw("&lt;edit-array asp-array-id=\"attr-styles\"\n            asp-items=\"Model.StyledMembers\"\n            asp-view-name=\"~/Views/TagHelperExamples/EditArray/_PersonEditor.cshtml\"\n            asp-display-view-name=\"~/Views/TagHelperExamples/EditArray/_PersonDisplay.cshtml\"\n            asp-display-mode=\"true\"\n            asp-cancel-text=\"Discard\"\n            asp-container-class=\"border border-warning rounded p-3 bg-light\"\n            asp-item-class=\"border rounded p-2 mb-2\"\n            asp-button-class=\"btn btn-outline-primary\"&gt;\n&lt;/edit-array&gt;")</code></pre>
            </div>
        </div>
    </section>

    <section class="example-section" id="reordering">
        <h2>Reordering controls</h2>
        <p class="example-description">
            Enable reordering and customize the move button text and classes.
        </p>

        <div class="example-container row g-3">
            <div class="example-rendered col-lg-6">
                <h3 class="h6">Result</h3>
                <edit-array asp-array-id="attr-reorder"
                            asp-items="Model.ReorderMembers"
                            asp-view-name="~/Views/TagHelperExamples/EditArray/_PersonEditor.cshtml"
                            asp-display-view-name="~/Views/TagHelperExamples/EditArray/_PersonDisplay.cshtml"
                            asp-display-mode="true"
                            asp-cancel-text="Cancel"
                            asp-enable-reordering="true"
                            asp-reorder-button-class="btn btn-outline-dark btn-sm"
                            asp-move-up-text="Up"
                            asp-move-down-text="Down">
                </edit-array>
            </div>
            <div class="example-source col-lg-6">
                <h3 class="h6">Source</h3>
                <pre><code class="language-cshtml">@Html.Raw("&lt;edit-array asp-array-id=\"attr-reorder\"\n            asp-items=\"Model.ReorderMembers\"\n            asp-view-name=\"~/Views/TagHelperExamples/EditArray/_PersonEditor.cshtml\"\n            asp-display-view-name=\"~/Views/TagHelperExamples/EditArray/_PersonDisplay.cshtml\"\n            asp-display-mode=\"true\"\n            asp-cancel-text=\"Cancel\"\n            asp-enable-reordering=\"true\"\n            asp-reorder-button-class=\"btn btn-outline-dark btn-sm\"\n            asp-move-up-text=\"Up\"\n            asp-move-down-text=\"Down\"&gt;\n&lt;/edit-array&gt;")</code></pre>
            </div>
        </div>
    </section>

    <section class="example-section" id="custom-button-text">
        <h2>Custom button text</h2>
        <p class="example-description">
            Replace the default labels for edit, delete, undelete, done, and cancel actions.
        </p>

        <div class="example-container row g-3">
            <div class="example-rendered col-lg-6">
                <h3 class="h6">Result</h3>
                <edit-array asp-array-id="attr-button-text"
                            asp-items="Model.ButtonTextMembers"
                            asp-view-name="~/Views/TagHelperExamples/EditArray/_PersonEditor.cshtml"
                            asp-display-view-name="~/Views/TagHelperExamples/EditArray/_PersonDisplay.cshtml"
                            asp-display-mode="true"
                            asp-edit-text="Open"
                            asp-delete-text="Remove"
                            asp-undelete-text="Restore"
                            asp-done-text="Close"
                            asp-cancel-text="Abort">
                </edit-array>
            </div>
            <div class="example-source col-lg-6">
                <h3 class="h6">Source</h3>
                <pre><code class="language-cshtml">@Html.Raw("&lt;edit-array asp-array-id=\"attr-button-text\"\n            asp-items=\"Model.ButtonTextMembers\"\n            asp-view-name=\"~/Views/TagHelperExamples/EditArray/_PersonEditor.cshtml\"\n            asp-display-view-name=\"~/Views/TagHelperExamples/EditArray/_PersonDisplay.cshtml\"\n            asp-display-mode=\"true\"\n            asp-edit-text=\"Open\"\n            asp-delete-text=\"Remove\"\n            asp-undelete-text=\"Restore\"\n            asp-done-text=\"Close\"\n            asp-cancel-text=\"Abort\"&gt;\n&lt;/edit-array&gt;")</code></pre>
            </div>
        </div>
    </section>

    <section class="example-section" id="callbacks">
        <h2>Callback hooks</h2>
        <p class="example-description">
            Use asp-on-update and asp-on-delete with <code>editArrayCallbacks</code> to register named callbacks via the companion library.
        </p>

        <div class="example-container row g-3">
            <div class="example-rendered col-lg-6">
                <h3 class="h6">Result</h3>
                <edit-array asp-array-id="attr-callbacks"
                            asp-items="Model.CallbackMembers"
                            asp-view-name="~/Views/TagHelperExamples/EditArray/_PersonEditor.cshtml"
                            asp-display-view-name="~/Views/TagHelperExamples/EditArray/_PersonDisplay.cshtml"
                            asp-display-mode="true"
                            asp-cancel-text="Cancel"
                            asp-on-update="handleMemberUpdated"
                            asp-on-delete="handleMemberDeleted">
                </edit-array>
                <div class="alert alert-info mt-2" id="callback-status">Waiting for an update or delete action.</div>
            </div>
            <div class="example-source col-lg-6">
                <h3 class="h6">Source</h3>
                <pre><code class="language-cshtml">@Html.Raw("&lt;edit-array asp-array-id=\"attr-callbacks\"\n            asp-on-update=\"handleMemberUpdated\"\n            asp-on-delete=\"handleMemberDeleted\" ...&gt;\n&lt;/edit-array&gt;\n&lt;div class=\"alert alert-info mt-2\" id=\"callback-status\"&gt;...&lt;/div&gt;")</code></pre>
                <pre class="mt-2"><code class="language-javascript">@Html.Raw("editArrayCallbacks.register('handleMemberUpdated',\n    editArrayCallbacks.statusUpdater({\n        elementId: 'callback-status',\n        message: (itemId) => 'Updated item: ' + itemId\n    })\n);\n\neditArrayCallbacks.register('handleMemberDeleted',\n    editArrayCallbacks.statusUpdater({\n        elementId: 'callback-status',\n        message: (itemId) => 'Toggled delete for: ' + itemId\n    })\n);")</code></pre>
            </div>
        </div>
    </section>

    <section class="example-section" id="done-hook">
        <h2>Done hook with validation guard</h2>
        <p class="example-description">
            Use the built-in <code>editArrayCallbacks.validationGuard()</code> to block closing when validation errors exist. No hand-written guard function needed.
        </p>

        <div class="example-container row g-3">
            <div class="example-rendered col-lg-6">
                <h3 class="h6">Result</h3>
                <form id="done-hook-form" novalidate>
                    <edit-array asp-array-id="attr-done-hook"
                                asp-items="Model.DoneHookMembers"
                                asp-view-name="~/Views/TagHelperExamples/EditArray/_PersonEditor.cshtml"
                                asp-display-view-name="~/Views/TagHelperExamples/EditArray/_PersonDisplay.cshtml"
                                asp-display-mode="true"
                                asp-cancel-text="Cancel"
                                asp-on-done="guardDoneAction">
                    </edit-array>
                </form>
                <div class="alert alert-warning mt-2" id="done-hook-status">Attempt an edit, then click Done.</div>
            </div>
            <div class="example-source col-lg-6">
                <h3 class="h6">Source</h3>
                <pre><code class="language-cshtml">@Html.Raw("&lt;form id=\"done-hook-form\" novalidate&gt;\n    &lt;edit-array asp-array-id=\"attr-done-hook\"\n                asp-on-done=\"guardDoneAction\" ...&gt;\n    &lt;/edit-array&gt;\n&lt;/form&gt;\n&lt;div class=\"alert alert-warning mt-2\" id=\"done-hook-status\"&gt;...&lt;/div&gt;")</code></pre>
                <pre class="mt-2"><code class="language-javascript">@Html.Raw("editArrayCallbacks.register('guardDoneAction',\n    editArrayCallbacks.validationGuard({\n        statusElementId: 'done-hook-status',\n        validMessage: 'Allowed: Done action proceeded.',\n        invalidMessage: 'Blocked: resolve validation errors before closing.',\n        validClass: 'alert alert-success mt-2',\n        invalidClass: 'alert alert-danger mt-2'\n    })\n);")</code></pre>
            </div>
        </div>
        <div class="example-notes">
            <strong>Note:</strong> The <code>validationGuard</code> factory handles both jQuery unobtrusive validation and plain validation-span fallback. Returning <code>false</code> keeps the edit container open.
        </div>
    </section>

    <section class="example-section" id="empty-placeholder">
        <h2>Empty placeholder</h2>
        <p class="example-description">
            Use asp-empty-placeholder to render guidance text when there are no items.
        </p>

        <div class="example-container row g-3">
            <div class="example-rendered col-lg-6">
                <h3 class="h6">Result</h3>
                <edit-array asp-array-id="attr-empty"
                            asp-items="Model.EmptyMembers"
                            asp-view-name="~/Views/TagHelperExamples/EditArray/_PersonEditor.cshtml"
                            asp-display-view-name="~/Views/TagHelperExamples/EditArray/_PersonDisplay.cshtml"
                            asp-empty-placeholder="No members yet. Use Add to get started."
                            asp-template="true"
                            asp-add-button="true">
                </edit-array>
            </div>
            <div class="example-source col-lg-6">
                <h3 class="h6">Source</h3>
                <pre><code class="language-cshtml">@Html.Raw("&lt;edit-array asp-array-id=\"attr-empty\"\n            asp-items=\"Model.EmptyMembers\"\n            asp-view-name=\"~/Views/TagHelperExamples/EditArray/_PersonEditor.cshtml\"\n            asp-display-view-name=\"~/Views/TagHelperExamples/EditArray/_PersonDisplay.cshtml\"\n            asp-empty-placeholder=\"No members yet. Use Add to get started.\"\n            asp-template=\"true\"\n            asp-add-button=\"true\"&gt;\n&lt;/edit-array&gt;")</code></pre>
            </div>
        </div>
    </section>
</div>

@section Scripts {
    <script>
        // Callback hooks section: use editArrayCallbacks to register named callbacks
        editArrayCallbacks.register('handleMemberUpdated',
            editArrayCallbacks.statusUpdater({
                elementId: 'callback-status',
                message: (itemId) => 'Updated item: ' + itemId
            })
        );

        editArrayCallbacks.register('handleMemberDeleted',
            editArrayCallbacks.statusUpdater({
                elementId: 'callback-status',
                message: (itemId) => 'Toggled delete for: ' + itemId
            })
        );

        // Done hook section: use the built-in validation guard
        editArrayCallbacks.register('guardDoneAction',
            editArrayCallbacks.validationGuard({
                statusElementId: 'done-hook-status',
                validMessage: 'Allowed: Done action proceeded.',
                invalidMessage: 'Blocked: resolve validation errors before closing.',
                validClass: 'alert alert-success mt-2',
                invalidClass: 'alert alert-danger mt-2'
            })
        );
    </script>
    <partial name="_ValidationScriptsPartial" />
}
